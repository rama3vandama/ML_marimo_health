<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–î–µ–º–æ –¥—ç—à–±–æ—Ä–¥–∞</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .dashboard {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        .controls {
            display: flex;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }
        .control-group {
            flex: 1;
            min-width: 200px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        .stat-value {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        .plot-container {
            margin: 30px 0;
            height: 400px;
        }
        select, input[type="range"] {
            width: 100%;
            padding: 10px;
            margin-top: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        label {
            font-weight: bold;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="dashboard">
        <h1>üìà –î–µ–º–æ: –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–∞–∂ –ø–æ –≥–æ—Ä–æ–¥–∞–º</h1>
        <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —á–∏—Å—Ç–æ–º JavaScript</p>
        
        <div class="controls">
            <div class="control-group">
                <label for="city-select">üèôÔ∏è –í—ã–±–µ—Ä–∏—Ç–µ –≥–æ—Ä–æ–¥:</label>
                <select id="city-select">
                    <option value="–ú–æ—Å–∫–≤–∞">–ú–æ—Å–∫–≤–∞</option>
                    <option value="–°–ü–±">–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥</option>
                    <option value="–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫">–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫</option>
                    <option value="–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥">–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥</option>
                    <option value="–ö–∞–∑–∞–Ω—å">–ö–∞–∑–∞–Ω—å</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="month-select">üìÖ –ú–µ—Å—è—Ü:</label>
                <select id="month-select">
                    <option value="–Ø–Ω–≤–∞—Ä—å">–Ø–Ω–≤–∞—Ä—å</option>
                    <option value="–§–µ–≤—Ä–∞–ª—å">–§–µ–≤—Ä–∞–ª—å</option>
                    <option value="–ú–∞—Ä—Ç">–ú–∞—Ä—Ç</option>
                    <option value="–ê–ø—Ä–µ–ª—å">–ê–ø—Ä–µ–ª—å</option>
                </select>
            </div>
            
            <div class="control-group">
                <label for="metric-range">üéØ –¶–µ–ª–µ–≤–æ–π –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å: <span id="metric-value">75</span>%</label>
                <input type="range" id="metric-range" min="0" max="100" value="75">
            </div>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div>–û–±—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏</div>
                <div class="stat-value" id="total-sales">1,250K</div>
                <div>—Ç—ã—Å. —Ä—É–±–ª–µ–π</div>
            </div>
            <div class="stat-card">
                <div>–°—Ä–µ–¥–Ω–∏–π —á–µ–∫</div>
                <div class="stat-value" id="avg-check">4,850</div>
                <div>—Ä—É–±–ª–µ–π</div>
            </div>
            <div class="stat-card">
                <div>–ö–ª–∏–µ–Ω—Ç–æ–≤</div>
                <div class="stat-value" id="clients">258</div>
                <div>—á–µ–ª–æ–≤–µ–∫</div>
            </div>
            <div class="stat-card">
                <div>–ö–æ–Ω–≤–µ—Ä—Å–∏—è</div>
                <div class="stat-value" id="conversion">15.8%</div>
                <div>–ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤</div>
            </div>
        </div>
        
        <div class="plot-container" id="plot"></div>
        
        <div style="background: #f0f8ff; padding: 20px; border-radius: 10px; margin-top: 30px;">
            <h3>üìä –î–∞–Ω–Ω—ã–µ –≤ —Ç–∞–±–ª–∏—Ü–µ:</h3>
            <table id="data-table" style="width: 100%; border-collapse: collapse; margin-top: 15px;">
                <thead>
                    <tr style="background: #e3f2fd;">
                        <th style="padding: 10px; text-align: left;">–ì–æ—Ä–æ–¥</th>
                        <th style="padding: 10px; text-align: left;">–ü—Ä–æ–¥–∞–∂–∏</th>
                        <th style="padding: 10px; text-align: left;">–†–æ—Å—Ç</th>
                        <th style="padding: 10px; text-align: left;">–î–æ–ª—è</th>
                    </tr>
                </thead>
                <tbody id="table-body">
                    <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è JavaScript -->
                </tbody>
            </table>
        </div>
        
        <div style="margin-top: 30px; padding: 20px; background: #fff3cd; border-radius: 10px;">
            <h3>üí° –≠—Ç–æ –¥–µ–º–æ-–≤–µ—Ä—Å–∏—è</h3>
            <p>–î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —Å–∫–∞—á–∞–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ <code>my_dashboard.py</code> –ª–æ–∫–∞–ª—å–Ω–æ:</p>
            <pre style="background: white; padding: 15px; border-radius: 5px; overflow-x: auto;">
# –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
pip install marimo
marimo edit my_dashboard.py</pre>
        </div>
    </div>
    
    <script>
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ
        const data = {
            "–ú–æ—Å–∫–≤–∞": { sales: 1250000, avgCheck: 4850, clients: 258, growth: 12.5 },
            "–°–ü–±": { sales: 890000, avgCheck: 4200, clients: 212, growth: 8.7 },
            "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫": { sales: 450000, avgCheck: 3800, clients: 118, growth: 15.2 },
            "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥": { sales: 520000, avgCheck: 3950, clients: 132, growth: 9.8 },
            "–ö–∞–∑–∞–Ω—å": { sales: 380000, avgCheck: 3650, clients: 104, growth: 11.3 }
        };
        
        const months = ["–Ø–Ω–≤–∞—Ä—å", "–§–µ–≤—Ä–∞–ª—å", "–ú–∞—Ä—Ç", "–ê–ø—Ä–µ–ª—å"];
        const monthlyData = {
            "–Ø–Ω–≤–∞—Ä—å": [100, 85, 70, 65, 60],
            "–§–µ–≤—Ä–∞–ª—å": [120, 95, 80, 75, 70],
            "–ú–∞—Ä—Ç": [140, 110, 90, 85, 80],
            "–ê–ø—Ä–µ–ª—å": [125, 105, 88, 82, 78]
        };
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function initDashboard() {
            updateStats();
            updatePlot();
            updateTable();
            
            // –°–ª—É—à–∞—Ç–µ–ª–∏ —Å–æ–±—ã—Ç–∏–π
            document.getElementById('city-select').addEventListener('change', updateDashboard);
            document.getElementById('month-select').addEventListener('change', updateDashboard);
            document.getElementById('metric-range').addEventListener('input', function(e) {
                document.getElementById('metric-value').textContent = e.target.value;
                updateDashboard();
            });
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ–π –ø–∞–Ω–µ–ª–∏
        function updateDashboard() {
            updateStats();
            updatePlot();
            updateTable();
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        function updateStats() {
            const city = document.getElementById('city-select').value;
            const metric = parseInt(document.getElementById('metric-range').value) / 100;
            const cityData = data[city];
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –º–µ—Ç—Ä–∏–∫—É –∫ –¥–∞–Ω–Ω—ã–º
            document.getElementById('total-sales').textContent = 
                formatNumber(cityData.sales * metric);
            document.getElementById('avg-check').textContent = 
                formatNumber(cityData.avgCheck * metric, 0);
            document.getElementById('clients').textContent = 
                Math.round(cityData.clients * metric);
            document.getElementById('conversion').textContent = 
                (15.8 * metric).toFixed(1) + '%';
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        function updatePlot() {
            const month = document.getElementById('month-select').value;
            const city = document.getElementById('city-select').value;
            const metric = parseInt(document.getElementById('metric-range').value) / 100;
            
            const cities = Object.keys(data);
            const sales = monthlyData[month].map(value => value * metric * 10000);
            
            const trace = {
                x: cities,
                y: sales,
                type: 'bar',
                marker: {
                    color: cities.map(c => c === city ? '#764ba2' : '#667eea'),
                    line: { color: '#ffffff', width: 2 }
                },
                text: sales.map(s => formatNumber(s)),
                textposition: 'auto'
            };
            
            const layout = {
                title: `–ü—Ä–æ–¥–∞–∂–∏ –ø–æ –≥–æ—Ä–æ–¥–∞–º (${month})`,
                xaxis: { title: '–ì–æ—Ä–æ–¥–∞' },
                yaxis: { title: '–ü—Ä–æ–¥–∞–∂–∏, —Ç—ã—Å. —Ä—É–±.' },
                plot_bgcolor: '#f8f9fa',
                paper_bgcolor: '#f8f9fa'
            };
            
            Plotly.newPlot('plot', [trace], layout);
        }
        
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã
        function updateTable() {
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';
            
            const cities = Object.keys(data);
            const metric = parseInt(document.getElementById('metric-range').value) / 100;
            
            cities.forEach(city => {
                const cityData = data[city];
                const row = document.createElement('tr');
                row.style.borderBottom = '1px solid #ddd';
                
                row.innerHTML = `
                    <td style="padding: 10px;"><strong>${city}</strong></td>
                    <td style="padding: 10px;">${formatNumber(cityData.sales * metric)}</td>
                    <td style="padding: 10px; color: ${cityData.growth > 10 ? 'green' : 'orange'}">
                        ${cityData.growth}%
                    </td>
                    <td style="padding: 10px;">
                        <div style="background: #e0e0e0; border-radius: 3px;">
                            <div style="background: #667eea; height: 20px; width: ${cityData.growth}%; border-radius: 3px;"></div>
                        </div>
                    </td>
                `;
                
                tbody.appendChild(row);
            });
        }
        
        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–∏—Å–µ–ª
        function formatNumber(num, decimals = 1) {
            if (num >= 1000000) {
                return (num / 1000000).toFixed(decimals) + 'M';
            } else if (num >= 1000) {
                return (num / 1000).toFixed(decimals) + 'K';
            }
            return num.toFixed(decimals);
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', initDashboard);
    </script>
</body>
</html>
